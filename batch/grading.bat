@echo off
rem remove certs without prompt https://superuser.com/questions/191038/installing-deleting-root-certificate-without-certmgr-certutil-asking-the-end-u
Powershell "$script = '_School\ME 106\Student submissions\grader.ps1'; $user = 'Jason Loucks'; Get-ChildItem Cert:\CurrentUser\ -Recurse | Where-Object {$_.Subject -match $user} | Remove-Item; $authenticode = New-SelfSignedCertificate -Subject 'Jason Loucks' -CertStoreLocation Cert:\CurrentUser\My -Type CodeSigningCert; $rootStore = [System.Security.Cryptography.X509Certificates.X509Store]::new('Root','CurrentUser'); $rootStore.Open('ReadWrite'); $rootStore.Add($authenticode); $rootStore.Close(); $publisherStore = [System.Security.Cryptography.X509Certificates.X509Store]::new('TrustedPublisher','CurrentUser'); $publisherStore.Open('ReadWrite'); $publisherStore.Add($authenticode); $publisherStore.Close(); Get-ChildItem Cert:\CurrentUser\My | Where-Object {$_.Subject -eq 'CN=$user'}; Get-ChildItem Cert:\CurrentUser\Root | Where-Object {$_.Subject -eq 'CN=$user'}; Get-ChildItem Cert:\CurrentUser\TrustedPublisher | Where-Object {$_.Subject -eq 'CN=$user'}; $codeCertificate = Get-ChildItem Cert:\CurrentUser\My | Where-Object {$_.Subject -eq 'CN=Jason Loucks'}; Set-AuthenticodeSignature -FilePath $script -Certificate $codeCertificate -TimeStampServer http://timestamp.digicert.com"
Powershell "'%~dp0_School\ME 106\Student submissions\grader.ps1'"
rem PortableApps\SetUserFTA\SetUserFTA PortableApps\SetUserFTA\config.txt
rem Start.exe